---
title: 安装CENTOS7遇到启动问题
date: 2016-04-27 00:09:30
categories: CentOS
tags: [centos, centos7, 启动]
urlname: the_startup_problem_when_installing_centos7
---

## 文章更新

1. 20160427-初次成文

## 为什么会有这篇文章

首先，是因为想给自己的东芝笔记本换个系统，黑苹果以前折腾过，太麻烦，显卡驱动装不好很不爽，现在也不大想重新再回顾一遍，尤其是自己已经有了MBP的情况下。因此，选择了LINUX系统，看来看去，想找个深度LINUX作为入门，据说界面和XP很像，但是无奈，刻录的U盘，在第一次安装的时候，就不知道出了啥问题，在安装界面就出了问题。因此，看了下其他的带UI的系统，有人推荐UBUNTU，但是无意中发现CENTOS也有UI，因为自己使用过阿里云的服务器，对CENTOS搭建PHP环境相对熟悉，就选择了CENTOS 7来安装。<!-- more -->

其次，就要说到一个非常蛋疼的原因了。我的本本是东芝U800，应该是一年之前，不知道我脑子犯了什么病，给BIOS设置了一个密码，然后还把系统的启动顺序设置成了硬盘优先，然而让我几乎蛋碎的是，我把密码忘！记！了！（千万只草泥马奔腾而过！）我要给笔记本装系统，不能用U盘启动，因为硬盘先启动，然后如果我拔掉硬盘，可以从U盘启动，但是启动了，系统往哪里装呢？之前的解决办法非常麻烦，就是直接把笔记本拆了，拿出来硬盘，直接在另外一台电脑给这个硬盘分好区，激活第一个分区，然后GHOST把系统GHO文件直接恢复到第一个分区上，然后把硬盘装回去，再启动，就可以开始装系统了。这样的经历有2次，非常费劲，因为每次都要小心翼翼的拆螺丝装螺丝，而且之前，这个本本因为是超极本，非常薄，显示器的连接轴断了一次，去中关村150找人修好了，然后就更加不想拆装这个本本了。

最后，就回到了这篇文章的主题，因为如果没有前面两个问题，我这本本估计装CENTOS不会这么费劲。但是这次的经历，也让我想到了一个相对容易的解决办法，具体文章最后会说。

## U盘安装遇到/dev/root does not exist

U盘安装CENTOS 7，遇到这个错误

``` bash
Warning: /dev/root does not exist, could not boot
```

网上的解决方案一般是因为刻录出来的U盘卷标无法被CENTOS的安装程序识别，所以可以通过在WINDOWS系统下，修改U盘卷标为一个非常简单的名字，比如CENTOS，然后再进入U盘的EFI/BOOT目录，修改一个cfg文件来搞定。

但是这个方法没有解决我的问题，我做了第一步，就是修改了U盘的卷标为CENTOS，然后在U盘安装CENTOS7启动的时候，按TAB键，修改`CENTOS\x207\x20x86_64`为`CENTOS`，这样就可以顺利安装了。我这里发现了一个小问题，就是CENTOS系统对大小写敏感，因此，那个`CENTOS\x207\x20x86_64`的卷标，一定要写成CENTOS（全部大写），而不要只是删掉了CentOS后面的字符，这样同样不能继续安装。有人说了，那我把U盘的卷标也写成CentOS不就好了？那可不行，因为U盘的卷标，不支持小写字符...

## 删掉分区，重装时出现grub rescue

第一次装CENTOS7的时候，忘记装UI了，开机直接进入了提示符，对我这个菜鸟来说可有点郁闷，虽然我在阿里云上还算熟悉，但是起码有教程一步一步教我怎么配置环境，但是这新电脑你就直接给我一个提示符，啥UI没有，还是有点抬举我了，二话不说，重装！

然后，问题来了...开机就遇到了这个错误

``` accesslog
partition not found
```

我是把硬盘从本本上拆下来，然后安装到台式机上去删掉了分区，然后打算重新接回本本上重新安装一次系统的。想法很好，因为觉得这硬盘都干净了，应该会想第一次一样顺利，谁知道，当我接回去的时候，开机之后遇到了`partation not found`的错误，我当时就纳闷了，硬盘上怎么还有东西没删干净么？然后就算插上U盘启动，错误依旧，这时候我就知道了，这个硬盘虽然没有分区了，但是应该还有一些CENTOS的启动信息存在，这个信息应该存在了MBR或者分区表之类的地方（这个地方先这样说吧，因为我没深入研究，这里主要说的是解决办法）。

怎么解决呢？在网上搜索的时候，一般建议是用WINDOWS PE启动盘启动，然后进行MBR重建修复，但是这个办法对我来说太麻烦了。于是我就想找一种在WINDOWS 10下可以做的修复办法，还真被我找到了，就是DiskPart命令。

步骤如下，把那个看似干净的硬盘接到Windows电脑上，然后开启CMD环境，一次下面的命令。

``` accesslog
DISKPART #进入DISKPART环境
DISKPART> LIST DISK #列出所有硬盘
DISKPART> SELECT DISK 3 #3修改为你想操作的硬盘
DISKPART> CLEAN #从选中的磁盘中删除所有分区或卷格式
DISKPART> CREATE PARTITION PRIMARY #在当前基本磁盘上创建主要分区
DISKPART> ACTIVE #在基本磁盘上，将选中的分区标记为活动的
DISKPART> EXIT #退出DISKPART
DISKPART> EXIT #退出CMD
```

然后也不需要格式化，这个盘上的信息就彻底干净了，这时候把盘从WINDOWS系统接回要安装CENTOS的电脑，就可以重新安装了。

## 参考资料

[DiskPart 命令介绍](https://technet.microsoft.com/zh-cn/library/cc766465.aspx)
