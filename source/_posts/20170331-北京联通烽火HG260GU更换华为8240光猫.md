---
title: 北京联通烽火HG260GU更换华为8240光猫
categories: 折腾
tags: [华为, 北京联通, 光纤, 光猫]
date: 2017-03-31 15:37:58
urlname: change_hg260gu_to_huawei_8240_for_beijing_unicom
---

## 文章更新

1. 20170330-初次成文

## 为什么会有这篇文章

装的北京联通200M宽带，修改了HG260G-U的配置，桥接了，但是到了路由器之后，每个单个设备的下载速度只有50M左右，说明这个烽火的路由器性能不咋地。直接淘宝了搞了个二手的华为8240，4口全是千兆口，入门级强悍！

## 更换光猫之前的准备工作

先来说说自己的光猫，我的光猫是烽火HG260G-U，采用的是GPON格式。

如果进入联通光猫的`192.168.1.1`可以看到一些参数，这些参数是需要“手抄”填写到华为8240里面的，这里先记录一下。

为了信息安全，敏感信息全部用xxx或者进行了马赛克处理。

![HG260GU的默认配置](Image.png)

记录一下：

|标题|内容|
|------|------|
|运营商:|北京联通|
|设备型号:|HG260G-U|
|设备标识号:|XXXXXX-XXXXXXXXXXXXXXXXXXXXXXX|
|MAC/SN:|FHTT17BF964A|
|硬件版本:|V2.0|
|软件版本:|G00L2.02|
|CPU使用情况:|14%|
|内存使用情况:|53%|

![HG260GU的默认配置2](Image [1].png)

数据太多，整理一下，方便大家查看。

![烽火HG260G-U的默认信息](Image-hg260info.png)

`60:B6:17:xx:xx:xx` 这是烽火猫背面的mac地址。

所以，从上面可以知道，设备的SN，就是FHHT+mac地址后面8位，设备的SN，就是设备的mac地址去掉冒号。

## 换上华为8240光猫

把原来烽火后面的光纤插头，小心的插在华为的后面，开机，进入新买的8240了。

需要注意的是，华为的默认管理地址是192.168.100.1，所以，设置电脑为192.168.100.2，子网掩码 255.255.255.0。

8240启动后，可以通过命令`ping 192.168.100.1`，显示有回复，但是网页端无法登录，无奈只好长按`reset`持续10秒钟以上，但是发现从网页端依然进入不了`192.168.100.1`的管理页面。

## 峰回路转

无意中发现可以进入telnet模式

打开cmd，输入命令

``` dos
telnet 192.168.100.1
```

账号root，密码root。

![华为8240的shell模式](Image [3].png)

进入后，发现这是一个迷你型的busybox linux系统，命令行模式和linux非常接近。

发现网上给的sudo su命令无法启用，然后无意中发现输入`?`，可以显示全部命令。

![华为8240的shell模式3](Image [4].png)

## 刷入原来烽火光猫的信息

将`60:B6:17:xx:xx:xx`和去掉冒号的mac地址，输入如下面命令中。

``` bash
set sn snid 60B617xxxxxx
set productmac MAC 60:B6:17:xx:xx:xx
set wanmac 60:B6:17:xx:xx:xx
set wanmac MAC 60:B6:17:xx:xx:xx
```

![华为8240的shell模式](Image [5].png)

![华为8240的shell模式](Image [6].png)

> 顺便说一下，华为8240的cpu是ar8316。

## 管理端如何进入？

我后来还是通过Google，找到了老周的一个帖子，他用了一些cmd脚本，来加速键盘输入，因为其实每次重启光猫后，是有几秒时间可以进入web的，就需要脚本配合，快速替换掉光猫内的设置信息，打开光猫的管理界面才可以。

[老周帖子地址](http://guanggai.org/thread-451-1-1.html)。

进入192.168.100.1后，账号是`telecomadmin`，密码`admintelecome`

![华为8240的登录界面](Image [8].png)

在系统工具中，可以看到SN已经设置成老光猫的信息，密码不要动。

![华为8240的管理界面](Image [9].png)

![华为8240的管理界面2](Image [10].png)

## 老周"使能"脚本到底是什么？

主要归结起来，就是下面这三句话

``` bash
set aclservicesrule HTTPLanEnable 1
set aclservicesrule TELNETLanEnable 1
save data
```

第一条命令，就是打开HTTP端访问，第二条是打开telnet访问，至于我的为什么可以直接telnet，我也不知道为什么。

## 升级8240的固件

其实这步可做可不做，主要是当时我刚写入老光猫的信息后，无法从联通局端获取到争取的ip信息，所以以为是固件版本的问题，但是其实是我的一个笔误，把SN写错了一个字母，蛋疼的错误。

升级固件之前，先把目前的固件信息备份一下

![华为8240的固件信息](Image [11].png)

好了，准备使用的是`HG8240V100R006C01SPC122_china_full_all.bin`这个固件，

选择bin文件之后，点`update firmware`的时候，会问你是否离开该页，记得要点离开，然后可以从浏览器的左下角看到上传的进度。

![升级华为8240的固件进度条](Image [12].png)

等1分钟吧，就成功了。

![固件刷新成功的华为8240](Image [13].png)

然后再次进入192.168.100.1

界面换了，果然漂亮了一些

![升级后的华为8240](Image [14].png)

![升级后的华为8240](Image [15].png)

## 拨号651错误

这个也是我当时犯错之后，看不到windows 10拨号错误具体是什么，还需要从windows的错误日志中找到具体的错误编号。

![Windows 10中寻找错误信息](Image [16].png)

## 参考文章

1. [老周光改日记](http://guanggai.org/thread-451-1-1.html)